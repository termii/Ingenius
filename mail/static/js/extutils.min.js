/*!
 * Copyright 2004-2015, AfterLogic Corp.
 * Licensed under AGPLv3 license or AfterLogic license
 * if commerical version of the product was purchased.
 * See the LICENSE file for a full license statement.
 */
!function(t){"use strict";var i={};t.Utils=i,i.Common={},i.Common.getRequestParam=function(t){var i=""!==location.search?location.search.substr(1).split("&"):[],a=[],n=null;return i.length>0&&_.each(i,function(t){var i=t.split("=");a[i[0]]=i[1]}),void 0!==a[t]&&(n=a[t]),n},i.File={},i.File.getViewLinkByHash=function(t,i,a,n){return"boolean"!=typeof a&&(a=!1),"string"!=typeof n&&(a=""),"?/Raw/View/"+t+"/"+i+"/"+(a?"1":"0")+(""===n?"":"/"+n)},"object"!=typeof i&&(t.Utils={}),i.Message={},i.Message.showInlinePictures=function(t,i,a,n){var e=function(t){return _.find(i,function(i){return i.CID===t})},r=function(t){return _.find(i,function(i){return i.ContentLocation===t})};"string"!=typeof n&&(n=""),a.length>0&&($("[data-x-src-cid]",t).each(function(){var t=$(this).attr("data-x-src-cid"),i=e(t);i&&i.ViewLink.length>0&&$(this).attr("src",n+i.ViewLink)}),$("[data-x-style-cid]",t).each(function(){var t="",i=$(this).attr("data-x-style-cid-name"),a=$(this).attr("data-x-style-cid"),n=e(a);n&&n.ViewLink.length>0&&""!==i&&(t=$.trim($(this).attr("style")),t=""===t?"":";"===t.substr(-1)?t+" ":t+"; ",$(this).attr("style",t+i+": url('"+n.ViewLink+"')"))})),$("[data-x-src-location]",t).each(function(){var t=$(this).attr("data-x-src-location"),i=r(t);i||(i=e(t)),i&&i.ViewLink.length>0&&$(this).attr("src",n+i.ViewLink)})},i.Message.showExternalPictures=function(t){$("[data-x-src]",t).each(function(){$(this).attr("src",$(this).attr("data-x-src")).removeAttr("data-x-src")}),$("[data-x-style-url]",t).each(function(){var t=$.trim($(this).attr("style"));t=""===t?"":";"===t.substr(-1)?t+" ":t+"; ",$(this).attr("style",t+$(this).attr("data-x-style-url")).removeAttr("data-x-style-url")})}}(window);
